<div class="container">
    @model ViewModel

    <div class="">
        <div id="demo" class="carousel slide" data-bs-ride="carousel" data-aos="fade-down">

            <!-- Indicators/dots -->
            <div class="carousel-indicators">
                <button type="button" data-bs-target="#demo" data-bs-slide-to="0" class="active"></button>
                <button type="button" data-bs-target="#demo" data-bs-slide-to="1" class=""></button>
                <button type="button" data-bs-target="#demo" data-bs-slide-to="2" class=""></button>
                <button type="button" data-bs-target="#demo" data-bs-slide-to="3" class=""></button>
            </div>

            <!-- The slideshow/carousel -->
            <div class="carousel-inner rounded-4">
                <div class="carousel-item active">
                    <img src="https://images.samsung.com/vn/smartphones/galaxy-s24/buy/kv_combo_PC.jpg?imbypass=true" alt="Los Angeles" class="d-block" style="width:100%">
                    <div class="carousel-caption text-start">
                        <h3>Samsung Galaxy S</h3>
                        <p class="badge bg-primary-subtle opacity-75 rounded">Cho trải nghiệm thêm sắc màu</p>
                    </div>
                </div>
                <div class="carousel-item">
                    <img src="https://images.samsung.com/vn/smartphones/galaxy-s24/buy/kv_exclusive_PC.jpg?imbypass=true" alt="Chicago" class="d-block" style="width:100%">
                </div>
                <div class="carousel-item">
                    <img src="https://images.samsung.com/vn/smartphones/galaxy-s24/buy/kv_group_PC.jpg?imbypass=true" alt="New York" class="d-block" style="width:100%">
                </div>
                <div class="carousel-item">
                    <img src="https://images.samsung.com/is/image/samsung/assets/vn/smartphones/galaxy-s24/buy/S24S24PlusPre-order-KV_PC.jpg?imbypass=true" alt="New York" class="d-block" style="width:100%">
                    <div class="carousel-caption">
                    </div>
                </div>
            </div>

            <!-- Left and right controls/icons -->
            <button class="carousel-control-prev" type="button" data-bs-target="#demo" data-bs-slide="prev">
                <span class="carousel-control-prev-icon text-bg-primary rounded-3 text-start"></span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#demo" data-bs-slide="next">
                <span class="carousel-control-next-icon text-bg-primary rounded-3 text-start"></span>
            </button>
        </div>
    </div>

    <div class="row mt-4">
        <aside class="col-3" data-aos="fade-down" data-aos-duration="1400">
            <nav class="navbar navbar-expand-sm bg-light navbar-dark sticky-top rounded p-0 m-0 d-block border-0">
                <div class="container-fluid d-block rounded mb-2">
                    <div class="navbar-brand text-dark p-0 fs-5 fw-bolder mb-2 pt-2 hide-text">
                        Danh Mục
                    </div>
                    @foreach (var obj in Model.Categories)
                    {
                        <div class="row mb-2">
                            <a asp-controller="Home" asp-action="Index" asp-route-term="@obj.CategoryId" class="fs-6 text-dark d-flex mb-1 col-8"> @obj.CategoryName </a>
                        </div>
                    }
                    <hr />
                </div>
                <div class="container-fluid d-block rounded mb-2">
                    <div class="navbar-brand text-dark p-0 fs-5 fw-bolder mb-2 pt-2 hide-text">
                        Sắp xếp
                    </div>
                    @{
                        string priceSortOrder = ViewData["SortByPrice"].ToString();
                        string nameSortOrder = ViewData["SortByName"].ToString();
                        string priceSortBtnText = priceSortOrder == "Price" ? "giá tăng dần" : "giá giảm dần";
                        string nameSortBtnText = nameSortOrder == "Name" ? "Tên sản phẩm A-Z" : "Tên sản phẩm Z-A";
                    }

                    <a class="text-decoration-none fs-6 btn btn-primary rounded mb-2 form-control " asp-controller="Home" asp-action="Index" asp-route-orderBy="@ViewData["SortByPrice"]">@priceSortBtnText</a>
                    <a class="text-decoration-none fs-6 btn btn-primary rounded mb-2 form-control " asp-controller="Home" asp-action="Index" asp-route-orderBy="@ViewData["SortByName"]">@nameSortBtnText</a>
                    <a class="text-decoration-none fs-6 btn btn-primary rounded mb-2 form-control " asp-controller="Home" asp-action="Index" asp-route-orderBy="@ViewData["SortByDate"]">Mới nhất</a>
                    <hr />
                </div>
                <div class="container-fluid d-block rounded mb-2">
                    <div class="navbar-brand text-dark p-0 fs-5 fw-bolder mb-2 hide-text">
                        Khoảng giá
                    </div>
                    <form method="post" asp-action="Index">
                        <div class="mt-2 mb-2">
                            <label class="fs-6">giá trị thấp nhất</label>
                            <input name="start" type="number" class="form-control rounded" />
                        </div>
                        <div class="mt-2 mb-2">
                            <label class="fs-6">giá trị cao nhất</label>
                            <input name="end" type="number" class="form-control rounded" />
                        </div>
                        <div class="mt-4 mb-2 text-center">
                            <button type="submit" class="btn btn-outline-dark rounded">Xác nhận</button>
                        </div>
                    </form>
                    <hr />
                    <div class="pb-2">
                        <a class="btn btn-outline-dark rounded w-100" href="#">Trở Về đầu trang <i class="bi bi-arrow-up"></i></a>
                    </div>
                </div>

            </nav>

        </aside>
        <article class="col-9">
            <form class="mt-4 mb-4" asp-controller="Home" asp-action="Index">
                <div class="input-group" data-aos="fade-down" data-aos-duration="1450">
                    <input name="term" class="form-control border border-dark rounded rounded-end-0" placeholder="Nhập tên sản phẩm" />
                    <button type="submit" class="btn btn-primary rounded rounded-start-0">Tìm kiếm <i class="bi bi-search"></i></button>
                </div>
            </form>
            <div class="row">
                @{
                    var userId = User.Claims.FirstOrDefault(c => c.Type == "UserId")?.Value;
                    var user = Model.Users.FirstOrDefault(u => u.EUserId == userId);
                    var userCart = Model.Carts.FirstOrDefault(c => c.EUserId == userId);
                }
                @foreach (var obj in Model.Products)
                {
                    <div class="w-25 text-center col-md-3" data-aos="fade-down" data-aos-duration="1500">

                        <div class="bg-light border-0 shadow text-center me-2 rounded-2 text-decoration-none pool mb-0 w-100">
                            <div class="w-100 h-75">
                                <span class="badge bg-danger position-absolute w-25 fs-5 rounded" style="right:5px">@obj.Discount%</span>
                                <img src="@obj.ImageUrl" class="w-100 h-100 rounded-top-2 img-fluid card-img" />
                            </div>
                            <div>
                                <p class="hide-text">@obj.ProductName</p>
                                <p class="align-items-center hide-text text-danger fw-bold">@obj.Price.ToString("#,##0")<span class="fsl">đ</span></p>
                            </div>
                            <form method="post" asp-controller="Cart" asp-action="Index">
                                <button type="submit" asp-route-quantity="1" asp-route-cartId="@userCart?.CartId" asp-route-productId="@(obj.ProductId)" asp-controller="Cart" asp-action="Index" class="overlay d-flex align-items-center justify-content-center rounded-2 border-0">
                                    <i class="bi bi-cart-plus-fill fs-1"></i>
                                </button>
                            </form>
                        </div>
                        <a asp-route-quantity="1" asp-route-pId="@obj.ProductId" asp-action="ProductDetails" class="btn btn-outline-dark rounded mb-4">Chi tiết sản phẩm</a>
                    </div>
                }
            </div>

        </article>
        <div class="row">
            <div class="col-3"></div>
            <div class="col-9 d-flex justify-content-end">
                <nav aria-label="Page navigation example">
                    <ul class="pagination">
                        @if (Model.CurrentPage > 1)
                        {
                            <li class="page-item">
                                <a class="page-link" aria-label="Previous" asp-action="Index" asp-route-term="@ViewData["CurrentFilter"]" asp-route-orderBy="@ViewData["CurrentSort"]" asp-route-currentPage="@(Model.CurrentPage - 1)">
                                    <span aria-hidden="true">&laquo;</span>
                                    <span class="sr-only">Previous</span>
                                </a>
                            </li>
                        }
                        @for (int i = 1; i <= Model.TotalPages; i++)
                        {
                            @if (i == Model.CurrentPage)
                            {
                                <li class="page-item">
                                    <a class="page-link active" asp-action="Index"
                                       asp-route-orderBy="@ViewData["CurrentSort"]"
                                       asp-route-term="@ViewData["CurrentFilter"]"
                                       asp-route-currentPage="@i">@(i)</a>
                                </li>
                            }
                            else
                            {
                                <li class="page-item">
                                    <a class="page-link" asp-action="Index"
                                       asp-route-orderBy="@ViewData["CurrentSort"]"
                                       asp-route-term="@ViewData["CurrentFilter"]"
                                       asp-route-currentPage="@i">@(i)</a>
                                </li>
                            }
                        }
                        @if (Model.CurrentPage < Model.TotalPages)
                        {
                            <li class="page-item">
                                <a class="page-link" aria-label="Next" asp-action="Index" asp-route-term="@ViewData["CurrentFilter"]" asp-route-orderBy="@ViewData["CurrentSort"]" asp-route-currentPage="@(Model.CurrentPage + 1)">
                                    <span aria-hidden="true">&raquo;</span>
                                    <span class="sr-only">Next</span>
                                </a>
                            </li>
                        }
                    </ul>
                </nav>
            </div>
        </div>
    </div>


</div>